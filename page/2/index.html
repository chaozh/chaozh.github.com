<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>chaozh.com</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="系统架构,移动开发,独立游戏">
<meta property="og:type" content="website">
<meta property="og:title" content="chaozh.com">
<meta property="og:url" content="http://chaozh.github.com/page/2/index.html">
<meta property="og:site_name" content="chaozh.com">
<meta property="og:description" content="系统架构,移动开发,独立游戏">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="chaozh.com">
<meta name="twitter:description" content="系统架构,移动开发,独立游戏">
  
    <link rel="alternative" href="/atom.xml" title="chaozh.com" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">chaozh.com</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">超然台上仙的知识库|系统架构,移动开发,独立游戏</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/php-development-env-setup-in-win7-x64.html">PHP-WIN</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://chaozh.github.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-java-related-question" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/08/java-related-question/" class="article-date">
  <time datetime="2016-03-08T10:03:34.000Z" itemprop="datePublished">2016-03-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/面试总结/">面试总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/08/java-related-question/">Java架构师问题总结</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="常见面试流程"><a href="#常见面试流程" class="headerlink" title="常见面试流程"></a>常见面试流程</h2><ol>
<li><p>技术相关</p>
<ul>
<li>java语言（基本、容器、多线程、异常处理、JVM）</li>
<li>设计模式</li>
<li>Spring</li>
<li>MySQL、Redis等（JDBC）</li>
<li>前端相关</li>
<li>Shell相关</li>
<li>算法题</li>
</ul>
</li>
<li><p>项目相关 </p>
</li>
</ol>
<h2 id="Java语言基础"><a href="#Java语言基础" class="headerlink" title="Java语言基础"></a>Java语言基础</h2><h3 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h3><ol>
<li>绝对不能在构造函数中调用会被Override的函数</li>
<li>QA：builder模式与Config类(InstanceSpec)取舍? builder需要创建静态类</li>
<li>QA：构造函数什么时候可以抛异常?</li>
<li>Q：init私有方法什么时候使用? A:构造方法里面禁止加入任何业务逻辑，如果有初始化逻辑，请放在<code>init</code>方法中</li>
</ol>
<h3 id="String使用"><a href="#String使用" class="headerlink" title="String使用"></a>String使用</h3><ol>
<li>判断是否相等<strong>绝对</strong>不能直接使用”==”进行，可以使用<code>equals</code>方法</li>
<li>判断是否为空: <code>StringUtils.isBlank()</code>，<code>Str.isEmpty()</code>，<code>Str.length()==0</code></li>
<li>循环体内，字符串的联接方式，使用 StringBuilder的<code>append</code>方法进行扩展</li>
</ol>
<h3 id="集合使用"><a href="#集合使用" class="headerlink" title="集合使用"></a>集合使用</h3><ol>
<li>Array初始化<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new ArrayList&lt;Element&gt;(<span class="name">Arrays</span>.asList(<span class="name">array</span>))</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>使用工具类<code>Arrays.asList()</code>把数组转换成集合时，不能使用其修改集合相关的方法，它的add/remove/clear方法会抛出 UnsupportedOperationException异常。</p>
<ol>
<li><p>使用集合转数组的方法，必须使用集合的<code>toArray(T[] array)</code>，传入的是类型完全一样的数组，大小就是<code>list.size()</code>。</p>
</li>
<li><p>ArrayList的subList结果不可强转成ArrayList，否则会抛出ClassCastException</p>
</li>
<li><p>QA：集合接口的区别 list collection hashmap</p>
</li>
<li><p>不要在foreach循环里进行元素的remove/add操作。remove元素请使用Iterator方式，如果并发操作，需要对Iterator对象加锁</p>
</li>
<li><p>高度注意Map类集合 K/V 能不能存储 <code>null</code> 值的情况</p>
<p>| 集合类               | Key       | Value     | Super       | 说明    |<br>| —————– | ——— | ——— | ———– | —– |<br>| Hashtable         | 不允许为 null | 不允许为 null | Dictionary  | 线程安全  |<br>| ConcurrentHashMap | 不允许为 null | 不允许为 null | AbstractMap | 分段锁技术 |<br>| TreeMap           | 不允许为 null | 允许为 null  | AbstractMap | 线程不安全 |<br>| HashMap           | 允许为 null  | 允许为 null  | AbstractMap | 线程不安全 |</p>
</li>
<li><p>利用 Set 元素唯一的特性，可以快速对一个集合进行去重操作</p>
</li>
</ol>
<h3 id="Exception处理"><a href="#Exception处理" class="headerlink" title="Exception处理"></a>Exception处理</h3><ol>
<li>标准Exception分为两种expcetion，一种继承自RunTimeException，不需要方法捕捉，比如NullPointerException，IllegalStateException；另一种必须catch或throws，比如InterruptedException</li>
<li>推荐使用Preconditions.checkNotNull等工具</li>
<li>catch后的代码仍然会执行，返回值与抛出异常都需要满足匹配，try中抛出的异常就会被对应catch捕获，上一个catch中抛出也会被下一个catch捕获，如果分支继续抛异常来结束那么该分支可以忽略返回值<br>处理方法：1. 异常转义；2. 异常链接getCause</li>
<li>单元测试函数应该抛出任何异常</li>
<li><p>利用jdk7新语法自动关闭文件流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>(InputStream is = <span class="keyword">new</span> FileInputStream)&#123;</span><br><span class="line">	<span class="comment">//文件操作</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>对No such method error处理：打印出具体绑定类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Object&gt;.class.getProtectionDomain();</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="注释处理"><a href="#注释处理" class="headerlink" title="注释处理"></a>注释处理</h3><ol>
<li>Bean注入<br>@Autowired<br>ApplicationContext ac;<br>lockAnnotation = (LockAnnotation)ac.getBean(“LockAnnotation”)</li>
<li>@Service与@Resouce可以配合使用<br><a href="http://bit1129.iteye.com/blog/2114126" target="_blank" rel="noopener">http://bit1129.iteye.com/blog/2114126</a></li>
<li>AOP<br><a href="http://www.xdemo.org/springmvc-aop-annotation/" target="_blank" rel="noopener">http://www.xdemo.org/springmvc-aop-annotation/</a></li>
</ol>
<h3 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h3><ol>
<li><p>后台定时任务</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//start</span></span><br><span class="line">ScheduledExecutorService excutor = 	Excutor.<span class="keyword">new</span><span class="type">SingleThreadScheduledExecutor</span>();</span><br><span class="line">excutor.scheduleWithFixedDelay(runnable, time);</span><br><span class="line"><span class="comment">//end</span></span><br><span class="line">excutor.shutdown(); <span class="comment">//excutor.shutdownNow();</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>线程池</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Future&lt;<span class="keyword">Object</span>&gt;&gt; threads = Lists.newArrayList(); </span><br><span class="line">ExcutorService excutor = 	Excutors.newCachedThreadPool();</span><br><span class="line">Future&lt;<span class="keyword">Object</span>&gt; t = executor.submit(<span class="keyword">new</span> 	Callable&lt;<span class="keyword">Object</span>&gt;() &#123;</span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">Object</span> call() <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">//do sth here!</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">threads.<span class="built_in">add</span>(t);</span><br><span class="line"><span class="keyword">for</span>(Future&lt;<span class="keyword">Object</span>&gt; t: threads)</span><br><span class="line">	t.<span class="built_in">get</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>CountDownLatch与Semaphore使用</p>
<p>CountDownLatch设置初始值，调用<code>wait()</code>方法会阻塞直到被<code>notify()</code>方法唤醒；调用<code>countDown()</code>来减少值；创建时不会阻塞，需要调用<code>await()</code>阻塞直至计数值为0；该机制被设计为只会触发一次，因此不会有方法来还原初始值。</p>
<p>Semaphore设置初始值，调用<code>acquire()</code>方法减少该值否则阻塞直至计数值大于0，调用<code>release(num)</code>来增加值，调用<code>availablePermits()</code>判断是否阻塞</p>
</li>
<li><p>单例模式注意使用double check方法</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Helper <span class="title">getHelper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (helper == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (helper == <span class="keyword">null</span>) &#123;</span><br><span class="line">                helper = <span class="keyword">new</span> Helper();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> helper;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Q：该模式有失效的可能？ A：可参考 The “Double-Checked Locking is Broken” Declaration,推荐问题<br>解决方案中较为简单一种(适用于 JDK5 及以上版本)，将目标属性声明为 volatile 型。</p>
<ol>
<li><p>executor 重要的三个参数含义<br>corePoolSize, maxmumPoolSize, [keepAliveTime], BlockingQueue<runable></runable></p>
</li>
<li><p>多线程的方法</p>
</li>
</ol>
<h3 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h3><ol>
<li>有哪些垃圾回收器 优缺点 </li>
<li>四种导致full gc场景</li>
<li>持久代满了，gc不成功则out of memory</li>
<li>旧生代满了</li>
<li>新生代向S0和S1转移数据，S0和S1向旧生代转移数据，两边内存都设置较小，持续进行导致</li>
<li>直接system.gc</li>
<li>Q: 原子变量实现? 设置unsafe 内存交换</li>
<li>给 JVM 设置-XX:+HeapDumpOnOutOfMemoryError 参数，让 JVM 碰到 OOM 场景时输出 dump 信息。</li>
</ol>
<h3 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h3><ol>
<li>Q: 何时使用乐观锁 悲观锁 出现场景，jdbc事务提交使用哪种锁（一般使用DB的悲观锁）</li>
</ol>
<h2 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h2><p>调优：tcp窗口，事务大小</p>
<ol>
<li>常用模块<br>aop, aspects, beans, core, context, expression, orm, jdbc, jms, tx, test, web, webmvc </li>
<li><p>主要接口</p>
</li>
<li><p>五种事务传播性Propagation<br>required, supports, mandatory, requires_new, not_supported, never, nested </p>
</li>
</ol>
<h2 id="netty"><a href="#netty" class="headerlink" title="netty"></a>netty</h2><p>结构 lf缺陷</p>
<h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><ol>
<li>设置AUTO_INCREMENT<br><a href="http://www.searchdatabase.com.cn/showcontent_38510.htm" target="_blank" rel="noopener">http://www.searchdatabase.com.cn/showcontent_38510.htm</a></li>
<li><p>使用datetime或timestamp类型，查询范围写法：send_time &lt;= ‘2015-09-24 15:24:16’</p>
<blockquote>
<p>区别：首先 DATETIM和TIMESTAMP类型所占的存储空间不同，前者8个字节，后者4个字节，这样造成的后果是两者能表示的时间范围不同。前者范围为1000-01-01 00:00:00 ~ 9999-12-31 23:59:59，后者范围为1970-01-01 08:00:01到2038-01-19 11:14:07。所以可以看到TIMESTAMP支持的范围比DATATIME要小,容易出现超出的情况.<br>其次，TIMESTAMP类型在默认情况下，insert、update 数据时，TIMESTAMP列会自动以当前时间（CURRENT_TIMESTAMP）填充/更新。<br>第三，TIMESTAMP比较受时区timezone的影响以及MYSQL版本和服务器的SQL MODE的影响<br>所以一般来说，我比较倾向选择DATETIME，至于你说到索引的问题，选择DATETIME作为索引，如果碰到大量数据查询慢的情况，也可以分区表解决。<br><strong>最佳实践：</strong> 只要用int类型存格林时间的unix timestamp值就好了，使用TIMESTAMP主要是为了方便记current_timestamp</p>
</blockquote>
</li>
<li><p>使用txt类型取代nvarchar<br>SQLserver 中使用nvarchar存储变长unicode字符串</p>
</li>
<li>使用tinyint(8)或bool(1)取代bit类型, int(32), bigint(64)</li>
<li>DEFAULT 为0，则可以查询’’（空字符串）；DEFAULT为NULL，则查询’’（空字符串）不匹配</li>
<li>业务ID自增设计<br><code>insert msgId into [table] value(select max(msgId) from [table] + 1)</code><br>这里max函数会导致锁表<br>解决方法：单记一个max version表，利用行锁进行多线程同步</li>
<li>当发生Too many connections时，即使是DBA也无法登录到数据库，一般的做法是修改配置文件的max_connections参数，然后重启数据库，这样业务就有几秒钟的中断。<br>还有一个hack的方法，用过gdb直接修改mysqld内存中max_connections的值，具体做法如下：<br><code>gdb -ex &quot;set max_connections=5000&quot; -batch -p &#39;pgrep -x mysqld&#39;</code></li>
<li>小数类型为 decimal，禁止使用 float 和 double。如果存储的数据范围超过 decimal 的范围，建议将数据拆成整数和小数分开存储。</li>
<li>表必备三字段:id, gmt_create, gmt_modified。</li>
<li>不得使用外键与级联，一切外键概念必须在应用层解决。更禁止使用存储过程。</li>
</ol>
<h2 id="JBOSS"><a href="#JBOSS" class="headerlink" title="JBOSS"></a>JBOSS</h2><p>调优方法</p>
<ol>
<li>connector 改为Nio</li>
<li>使用G1回收器，+UseG1GC 提供一种计算方法预期最大停止时间</li>
<li>调整内存使用</li>
</ol>
<h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><p>运用功能 模块实现 核心组件 upstream配置        </p>
<ol>
<li>高并发服务器建议调小 TCP 协议的 time_wait 超时时间，变更/etc/sysctl.conf 文件：net.ipv4.tcp_fin_timeout = 30</li>
</ol>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><ol>
<li>连接数</li>
<li>集群设置 集群算法</li>
</ol>
<h2 id="Curator"><a href="#Curator" class="headerlink" title="Curator"></a>Curator</h2><ol>
<li>使用InterProcessMutex中的RevocationListener因为在另一个专用线程因此没法直接调用release释放，Revoke唤醒需要使用对应的lock节点而不是目录<br>QA：这个设计很奇怪，按常理revoke应该调用在lock的path上然后自动通知当前获得锁的lock结构，并且应该有方法允许释放【可能状态比较难统一】</li>
<li>2.9版本之后可以自动清理锁目录，需要设置container.checkIntervalMs</li>
<li>共享锁实现<br><a href="http://www.tuicool.com/articles/yQBVfeA" target="_blank" rel="noopener">http://www.tuicool.com/articles/yQBVfeA</a></li>
<li>start方法只能在初始化后调用一次，close调用后只能销毁</li>
</ol>
<h2 id="Dubbo"><a href="#Dubbo" class="headerlink" title="Dubbo"></a>Dubbo</h2><ol>
<li>使用transient关键字保证成员不被串行化</li>
</ol>
<p>实现思路</p>
<h3 id="1-WS服务转RPC"><a href="#1-WS服务转RPC" class="headerlink" title="1. WS服务转RPC"></a>1. WS服务转RPC</h3><p>分为两个难点：wsdl信息提取，RPC服务端的API生成<br>wsdl信息提取：例如从BPM提取出ReceiveMsg方法与参数<br>RPC服务端API生成：<br><a href="http://dubbo.io/User+Guide-zh.htm#UserGuide-zh-API%E9%85%8D%E7%BD%AE" target="_blank" rel="noopener">http://dubbo.io/User+Guide-zh.htm#UserGuide-zh-API%E9%85%8D%E7%BD%AE</a><br>API方法所依赖的接口service与实现serviceImpl可以使用通用的泛化实现接口与实现<br><a href="http://dubbo.io/Generic+Implementation-zh.htm" target="_blank" rel="noopener">http://dubbo.io/Generic+Implementation-zh.htm</a></p>
<h3 id="2-RPC服务转WS"><a href="#2-RPC服务转WS" class="headerlink" title="2. RPC服务转WS"></a>2. RPC服务转WS</h3><p>分为两个难点：参考Dubbo客户端实现RPC客户端自动生成，WS服务端API生成<br>RPC信息提取：<br>WS服务端API生成：</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2016/03/08/java-related-question/" data-id="cjap5ltvc005qb8rldyvo7jyg" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2016/03/08/java-related-question/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JVM/">JVM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/事务/">事务</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-intro-openchain" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/07/intro-openchain/" class="article-date">
  <time datetime="2016-03-07T21:34:00.000Z" itemprop="datePublished">2016-03-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/系统经验/">系统经验</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/07/intro-openchain/">Open Chain系统设计</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="OpenChain简介"><a href="#OpenChain简介" class="headerlink" title="OpenChain简介"></a>OpenChain简介</h2><p><a href="https://github.com/openchain/openchain/" target="_blank" rel="noopener">openchain</a>使用C#开发的分布式总账系统，有比较强的横向扩展能力，并利用比特币的区块链保证不可更改性。</p>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><ol>
<li>openchain是一种区块链吗？<br>答：不是，其不使用块这个概念，并直接使用事务链。</li>
<li>openchain是一条侧链吗？<br>答：提供了模块将openchain部署为侧链，但并非必要步骤。</li>
</ol>
<h2 id="部署方法"><a href="#部署方法" class="headerlink" title="部署方法"></a>部署方法</h2><p>提供docker方法直接部署openchain的服务器，使用sqlite作为默认存储，运行在.NET Core和.NET Framework上面</p>
<h2 id="系统架构"><a href="#系统架构" class="headerlink" title="系统架构"></a>系统架构</h2><ol>
<li>事务流<br>openchain的服务节点可以分为两种：validator节点、observer节点：前者接收事务并进行验证，只有通过验证的才计入总账（验证规则由管理员配置）；后者会下载所有通过验证的事务信息流（形成备份？）</li>
<li>利用区块链<br> 即利用公链提交事务形成hash（使用OP_RETURN）</li>
<li>数据结构<br> 使用Protocol Buffers进行客户端与服务器之间的编解码操作</li>
<li>总账结构<br> kv结构的有层级的总账</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2016/03/07/intro-openchain/" data-id="cjap5ltv9005ib8rlw0h7jwof" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2016/03/07/intro-openchain/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/事务/">事务</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/区块链/">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-db-from-cmu-2016-three" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/01/db-from-cmu-2016-three/" class="article-date">
  <time datetime="2016-03-01T19:15:00.000Z" itemprop="datePublished">2016-03-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/课程总结/">课程总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/01/db-from-cmu-2016-three/">CMU课程15-721数据库系统设计（第三周）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CMU课程15-721最新一期开课啦！</p>
<p><a href="http://15721.courses.cs.cmu.edu/spring2016/schedule.html" target="_blank" rel="noopener">课程安排</a></p>
<p>索引技术课程（三节）介绍的技术实际跟并发控制结合很紧密，接下来讨论查询相关技术（穿插了日志技术内容）</p>
<h2 id="Query-Execution-amp-Scheduling"><a href="#Query-Execution-amp-Scheduling" class="headerlink" title="Query Execution &amp; Scheduling"></a>Query Execution &amp; Scheduling</h2><p>重点介绍查询执行与调度，特别是多用户DB中查询如何并行执行</p>
<p>处理进程模型：</p>
<ul>
<li>进程-woker 依赖OS调度，使用共享内存，例：DB2、Postgres、Oracle；还是因为当时没有linux设计</li>
<li>进程池 CPU缓存支持不好</li>
<li>线程-worker DB管控调度，新DB都用这个模型规避共享内存</li>
</ul>
<p>利用多核并发加速执行：</p>
<ul>
<li>Intra-Operator 在子集上独立运行相同函数（mapreduce）</li>
<li>Inter-Operator 运行类似流水线，做一部分工作（stream）</li>
</ul>
<p>个人补充：MySQL仍然是一个线程完成一个work</p>
<p>补充一点内存访问架构（实际是体系结构中重要部分，由硬件设计决定）</p>
<ul>
<li>UMA：多cpu与多内存都必须走中心bus</li>
<li>NUMA：几个cpu之间组成bus，cpu与内存一一对应(目前常用架构！)</li>
</ul>
<p>数据分配策略：</p>
<ul>
<li>内存分配与cpu绑定，参考linux的<code>move_pages</code></li>
<li>使用malloc</li>
</ul>
<p>将查询语句变为可调度的执行计划，OLTP简单，OLAP比较难。Hyper就是一个NUMA架构下多核横向分布动态调度架构：</p>
<p><a href="http://15721.courses.cs.cmu.edu/spring2016/papers/p743-leis.pdf" target="_blank" rel="noopener">Morsel-Driven Parallelism: A NUMA-Aware Query Evaluation Framework for the Many-Core Age</a></p>
<p>每个核分配一个worker（并行），pull接收分配的任务，数据分布采用RR算法</p>
<h2 id="Join-Alogrithms-I-—-Hashing"><a href="#Join-Alogrithms-I-—-Hashing" class="headerlink" title="Join Alogrithms I — Hashing"></a>Join Alogrithms I — Hashing</h2><p>原先不懂为何hash join算法作为第一个项目作业，而不是在介绍这个之后再布置。后来发现实际上这里讲解的是最新研究的多核版本算法</p>
<h2 id="Join-Alogrithms-II-—-Sort-Merge"><a href="#Join-Alogrithms-II-—-Sort-Merge" class="headerlink" title="Join Alogrithms II — Sort-Merge"></a>Join Alogrithms II — Sort-Merge</h2><h2 id="Logging-amp-Recovery-I-—-Physical-Logging"><a href="#Logging-amp-Recovery-I-—-Physical-Logging" class="headerlink" title="Logging &amp; Recovery I — Physical Logging"></a>Logging &amp; Recovery I — Physical Logging</h2><p>传统DB磁盘日志基于ARIES算法，使用fuzzy cp规则，管理Active Transan Table与Dirty Page Table，赋予LSN并在易失与非易失中都要维护，过程为：analysis,redo,undo。最慢的过程发生在其他事务等待log刷到磁盘。</p>
<p>mem DB就不需要维护Dirty Page Table，因为所有数据都在内存。undo记录也没必要存储。</p>
<p>实例是<strong>Silo</strong>系统，其将log，cp，恢复操作都并行化优化，<a href="http://15721.courses.cs.cmu.edu/spring2016/papers/zheng-osdi14.pdf" target="_blank" rel="noopener">论文</a>将这些设计考虑与最终选择都讲解的非常清晰。</p>
<p>该系统假设每个CPU socket对应有一个存储设备。每个设备分配一个日志线程，CPU socket对应一组工作线程。日志线程每10个epoch创建一个文件，将旧日志文件重命名并记录最大epoch。日志维护两个队列：Free Buffers与Flushing Buffers。会有一个特殊日志线程跟踪最新已经持久化的epoch(即各个日志线程中持久化的epoch最大值)，小于此epoch的事务信息才可以丢弃。</p>
<p>每个disk对应一个cp线程，该线程有可能因为分区而写多个文件（voltDB甚至直接使用MVCC的version来做cp），cp的频率。恢复也可以并行进行。使用YCSB和TPC-C测试，吞吐率损失10%，lantency没有统计。</p>
<h2 id="Logging-amp-Recovery-II-—-Alternative-Methods"><a href="#Logging-amp-Recovery-II-—-Alternative-Methods" class="headerlink" title="Logging &amp; Recovery II — Alternative Methods"></a>Logging &amp; Recovery II — Alternative Methods</h2><p>讨论一下逻辑日志，内存checkpoint以及Facebook的快速恢复方法（共享内存恢复）。</p>
<p>OLTP中节点失效很少见(数据不大，通常&lt;10个节点)，因此比较适合使用逻辑日志，记录格式通常包括（存储方法名，输入参数，额外安全检测信息），注意逻辑日志协议设计要满足可确定性，因此需要：</p>
<ul>
<li>事务执行前顺序已经固定</li>
<li>事务逻辑是确定的</li>
</ul>
<p>voltDB设计日志协议：在事务运行前日志就已经记录命令，且此时顺序已经分配完毕（个人理解类似MySQL），cp操作由特殊事务进行并将系统切换为COW模式，另一个特殊线程负责扫描表并制作快照，无视cp发起后的所有变化操作；DBMS同步不需要2PC协议</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2016/03/01/db-from-cmu-2016-three/" data-id="cjap5ltu9003ib8rl47gl5usl" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2016/03/01/db-from-cmu-2016-three/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/join/">join</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/日志/">日志</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/调度/">调度</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-db-from-cmu-2016-second-project" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/29/db-from-cmu-2016-second-project/" class="article-date">
  <time datetime="2016-02-29T10:03:34.000Z" itemprop="datePublished">2016-02-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/课程总结/">课程总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/29/db-from-cmu-2016-second-project/">CMU课程15-721数据库系统设计（第二个项目）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CMU课程15-721最新一期开课啦！</p>
<p><a href="http://15721.courses.cs.cmu.edu/spring2016/schedule.html" target="_blank" rel="noopener">课程安排</a></p>
<h2 id="Project-2-Concurrent-Index"><a href="#Project-2-Concurrent-Index" class="headerlink" title="Project #2 - Concurrent Index"></a>Project #2 - Concurrent Index</h2><p>实现一个支持无锁并发的BW树作为索引底层数据结构</p>
<ul>
<li>PID到指针的映射表</li>
<li>改动链</li>
<li>split/merge</li>
<li>动态垃圾回收</li>
</ul>
<p>论文中几个奇怪概念：</p>
<ul>
<li>install CAS 即使用CAS操作来替换映射表中的项目</li>
<li>epoch机制 即使用版本号保证没有其他操作正在进行（可以执行物理删除）</li>
</ul>
<p>实现要求：</p>
<ul>
<li>支持重复key且可以配置，如果配置为不允许则<code>InsertEntry</code>插入重复key的索引条目时返回<code>false</code>，且<code>DeleteEntry</code>只删除<key, value="">完全匹配的索引条目</key,></li>
<li>支持consolidation，需要考虑阈值</li>
<li>支持split与merge，特别是并发插入与删除的情况</li>
<li>应该有工具函数帮助测试结构完整性并可以修复，类似<code>fsck</code></li>
<li>支持动态垃圾回收，调用<code>Cleanup</code>函数进行物理释放，会使用<code>GetMemoryFootprint</code>统计内存情况</li>
<li>支持<code>reverse iterators</code>并保证<code>concurrent mutators</code>正常工作</li>
</ul>
<h2 id="Profile方法"><a href="#Profile方法" class="headerlink" title="Profile方法"></a>Profile方法</h2><p>profile工具使用valgrind或perf</p>
<ol>
<li>valgrind</li>
</ol>
<p>使用memcheck或callgrind动态检查：<code>valgrind --tool=callgrind --trace-children=yes ./build/src/peloton -D data &amp;&gt; /dev/null&amp;</code></p>
<ol>
<li>perf</li>
</ol>
<p>通过收集linux的cpu周期计数实现，也支持收集其他事件<br><code>perf record -e cycles:u -c 2000</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2016/02/29/db-from-cmu-2016-second-project/" data-id="cjap5ltu6003db8rlxcsiu4c7" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2016/02/29/db-from-cmu-2016-second-project/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/无锁并发/">无锁并发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/索引/">索引</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-db-from-cmu-2016-first-project" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/17/db-from-cmu-2016-first-project/" class="article-date">
  <time datetime="2016-02-17T10:03:34.000Z" itemprop="datePublished">2016-02-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/课程总结/">课程总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/17/db-from-cmu-2016-first-project/">CMU课程15-721数据库系统设计（第一个项目）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CMU课程15-721最新一期开课啦！</p>
<p><a href="http://15721.courses.cs.cmu.edu/spring2016/schedule.html" target="_blank" rel="noopener">课程安排</a></p>
<h2 id="Project-1-Hash-Join-Operator"><a href="#Project-1-Hash-Join-Operator" class="headerlink" title="Project #1 - Hash Join Operator"></a>Project #1 - Hash Join Operator</h2><p>做这个项目前必须了解几个join算法，问题是这些算法在本次课程里都没有讲解过。</p>
<p>1.嵌套循环连接(Nested Loops)</p>
<p>适用范围两个表, 一个叫外部表, 一个叫内部表。如果外部输入非常小，而内部输入非常大并且已预先建立索引，那么嵌套循环联接将特别有效率。循环嵌套连接查找内部循环表的次数等于外部循环的行数，当外部循环没有更多的行时，循环嵌套结束。</p>
<p>2.合并联接(Merge)</p>
<p>指两个表在on的过滤条件上都有索引, 都是有序的, 这样join时, sql server就会使用性能更好的Merge join算法。如果一个有索引,一个没索引,则会选择Nested Loops join算法。首先从两个输入集合中各取第一行，如果匹配，则返回匹配行。假如两行不匹配，则有较小值的输入集合+1。</p>
<p>3.哈希联接(Hash)</p>
<p>如果两个表在on的过滤条件上都没有索引, 则就会使用Hash join算法。也就是说, 使用Hash join算法是由于缺少现成的索引。</p>
<p>哈希匹配分为两个阶段,分别为生成和探测阶段：首先是生成阶段，将输入源中的每一个条目经过散列函数的计算都放到不同的Hash Bucket中；接下来是探测阶段，对于另一个输入集合，同样针对每一行进行散列函数，确定其所应在的Hash Bucket,在针对这行和对应Hash Bucket中的每一行进行匹配，如果匹配则返回对应的行。</p>
<p>同时做这个项目需要了解Peloton tile-based架构几个关键数据结构：</p>
<p><code>logical_tile</code>设计 [backend/executor/logical_tile] </p>
<p>其中</p>
<ul>
<li><code>position_lists_</code>为<code>vector&lt;vector&lt;oid_t&gt;&gt;</code> 用来描述tiles/colums, 例(1,2,3),(1,1,1)</li>
<li><code>schema_</code>为<code>vector&lt;LogicalTile::ColumnInfo&gt;</code> 用来描述logical tile的表字段组合, 会存在<code>position_list_idx</code>与position list对应, 例(Tile A-1 ATTR1, Tile A-1 ATTR2), (Tile A-1 ATTR3, Tile A-2 ATTR1)</li>
<li><code>visible_rows_</code>为<code>vector&lt;bool&gt;</code>用来描述position lists中每一行的可见性</li>
</ul>
<p><code>ColumnInfo</code>设计 [backend/executor/logical_tile]</p>
<p>在logical tile中用来描述一组表字段信息, 例如(Tile A-1 ATTR1, Tile A-1 ATTR2), 其中</p>
<ul>
<li><code>position_list_idx</code> 指回Position Lists中对应编号</li>
<li><code>base_tile</code>为<code>shared_ptr&lt;storage::Tile&gt;</code>指向存储Tile，直接使用指针而不是oid</li>
<li><code>origin_column_id</code> 存储Tile中选择的表字段编号</li>
</ul>
<p><code>ContainerTuple</code>设计 [backend/expression/container_tuple]</p>
<p>用于包装logical tile中元组, 传入LogicalTile指针与元组行id(logical_tile, row_idx)</p>
<p><code>HashMapType</code> 设计 [backend/executor/hash_executor]</p>
<p>用于定义hash表结构<code>unordered_map&lt;expression::ContainerTuple&lt;LogicalTile&gt;, unordered_set&lt;pair&lt;size_t, oid_t&gt;, boost::hash&lt;pair&lt;size_t, oid_t&gt;&gt;&gt;, expression::ContainerTupleHasher&lt;LogicalTile&gt;, expression::ContainerTupleComparator&lt;LogicalTile&gt;&gt;</code><br>其中pair<size_t, oid_t=""> 表示 <size_t tile_idx,="" oid_t="" row_idx=""></size_t></size_t,></p>
<p>使用类型为<code>vector&lt;unique_ptr&lt;executor::LogicalTile&gt;&gt;</code>的<code>left_result_tiles_</code>与<code>right_result_tiles_</code>缓存<br>最终hash操作返回结果为<code>vector&lt;LogicalTile *&gt; result</code>使用<code>BuildOutputLogicalTile</code>方法(主要调用<code>BuildSchema</code>方法得到表字段组合)返回得到<code>unique_ptr&lt;LogicalTile&gt;</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2016/02/17/db-from-cmu-2016-first-project/" data-id="cjap5ltu4003ab8rlxp8n0o92" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2016/02/17/db-from-cmu-2016-first-project/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/索引/">索引</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-db-from-cmu-2016-two" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/13/db-from-cmu-2016-two/" class="article-date">
  <time datetime="2016-02-13T09:14:57.000Z" itemprop="datePublished">2016-02-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/课程总结/">课程总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/13/db-from-cmu-2016-two/">CMU课程15-721数据库系统设计（第二周）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CMU课程15-721最新一期开课啦！</p>
<p><a href="http://15721.courses.cs.cmu.edu/spring2016/schedule.html" target="_blank" rel="noopener">课程安排</a></p>
<p>并发控制课程（一共三节）已经结束，但具体细节需要结合索引技术（仍然是三节）进行讲解</p>
<h2 id="Indexes-I-—-Locking-amp-Latching"><a href="#Indexes-I-—-Locking-amp-Latching" class="headerlink" title="Indexes I — Locking &amp; Latching"></a>Indexes I — Locking &amp; Latching</h2><p>本节就是对应用在传统B树索引上的各种锁和latch技术进行讲解</p>
<p>技术总结信息来自这篇文章：<a href="http://15721.courses.cs.cmu.edu/spring2016/papers/a16-graefe.pdf" target="_blank" rel="noopener">A Survey of B-Tree Locking Techniques</a></p>
<p>在讲解锁相关技术前，需要把B树家族的各个数据结构先总结说明一下。</p>
<p>B树(键值都在) -&gt; B+树(值都在叶子节点) 其中B+树设计选择有：</p>
<ul>
<li>Non-Unique索引 实现方法有1.允许键重复 2.值list</li>
<li>变长键 实现方法有1.指针 2.节点长度可变 3.key map（即slot pages）</li>
</ul>
<p>其他变形：</p>
<ul>
<li>T-tree, 基于AVL树（不存key直接存指针），用于内存DB</li>
<li>Skip List, MemSQL完全使用以替代B+结构，实现上为一组多层list，最低层为排序单链key，每层key减半，插入时几率插入每一层；优势是省空间，无需额外平衡操作，易并发；缺点是反向查找复杂</li>
<li>Radix Tree 基树</li>
<li>MassTree</li>
<li>Fractal Tree</li>
</ul>
<p>对索引加锁需要注意索引结构可能变化</p>
<ul>
<li>lock: 事务粒度上保护索引逻辑，txn duration，可以回滚，(ex,sh,up,i)</li>
<li>latch: 线程粒度上保护索引内部实现，op duration，不需要回滚，(r,w)</li>
</ul>
<p>因此lock-free index可以为no lock(MVCC)或no latch(cow,shadow page)</p>
<p>索引锁类型</p>
<ul>
<li>predicate lock 在where条件上加锁，不好实现</li>
<li>key-value lock 在B树key上加锁</li>
<li>gap lock 在B树key后面gap上加锁</li>
<li>key-range lock 在B树key及后面gap上加锁</li>
<li>hierachical lock 一组key-range lock纵向上组合(IX, EX)</li>
</ul>
<h2 id="Indexes-II-—-OLTP"><a href="#Indexes-II-—-OLTP" class="headerlink" title="Indexes II — OLTP"></a>Indexes II — OLTP</h2><p>本节先关注latch实现方法: </p>
<ul>
<li>Compare&amp;Swap CAS操作，使用<code>__sync_bool_compare_and_swap(&amp;M, 20, 30)</code> 是其他实现的基础</li>
<li>Os Mutex 使用<code>pthread_mutex_t</code> (,about 25ns invocation)</li>
<li>Test&amp;Set spinlock 使用<code>std::atomic_flag</code>(non-scalable, cpu缓存不友好)</li>
<li>Queue spinlock 使用<code>std::atomic_flag</code>(比mutex性能好，cpu缓存友好) lock chain</li>
<li>rw locks 可以使用spin lock实现</li>
</ul>
<p>其中non-scalable指锁阻塞后性能不能线性增长<br><a href="https://pdos.csail.mit.edu/6.828/2009/lec/l-mcs.html" target="_blank" rel="noopener">详细解释</a></p>
<p>个人补充：工程实践中共享对象的读写一致性方案(读写锁，COW与引用计数)，引用计数并发可以使用HazardPointer解决<br>个人补充：<a href="http://www.yebangyu.org/blog/2016/01/24/spinlock-and-mutex/" target="_blank" rel="noopener">spinlock vs mutex</a></p>
<p>重点讲解几个典型mem DB中OLTP索引设计：</p>
<ol>
<li>BW树(Hekaton)</li>
</ol>
<ul>
<li>latch free B+树</li>
<li>deltas 没有直接修改(使用额外record或info，物理page上挂链表)，建少cpu缓存失效，使用epoch方便垃圾回收</li>
<li>mapping table 树所有都使用pid，需要维护pid到page物理位置的指针表，CAS使用在该指针上 </li>
</ul>
<p>该技术来自微软Hekaton的这篇文章：<a href="http://15721.courses.cs.cmu.edu/spring2016/papers/bwtree-icde2013.pdf" target="_blank" rel="noopener">The Bw-Tree: A B-tree for New Hardware</a></p>
<ol>
<li>Concurrent skip list(MemSQL), latch free<br>仅使用CAS操作实现insert与update无锁化</li>
</ol>
<p>该技术来自这篇文章：<a href="http://15721.courses.cs.cmu.edu/spring2016/papers/pugh-skiplists1990.pdf" target="_blank" rel="noopener">Concurrent Maintenance of Skip Lists</a></p>
<ol>
<li>Adaptive基树(Hyper)</li>
</ol>
<h2 id="Indexes-III-—-OLAP"><a href="#Indexes-III-—-OLAP" class="headerlink" title="Indexes III — OLAP"></a>Indexes III — OLAP</h2><p>OLAP的不同在于可以drill down、roll up、slice、pivot等维度变化操作，本节主要讲解OLAP中列索引设计</p>
<p>个人补充：很多需要数据库行转列操作</p>
<p>Star Schema vs Snowflake Schema (分层级关系表) 使用B+树结构因为数据重复会导致大量的空间浪费，OLAP更适合采用列数据库模式(方便压缩)</p>
<p>SQL Server的列索引设计(如何在行存储上实现列索引)：最初设计表必须是只读的, 实现结构为segment directory即blob storage with dictionary/delta encode &amp; compress 针对不同数据类型采用不同编码方法；新版支持insert/update/delete, 采用delta store支持插入更新,bitmap实现删除</p>
<p>bitmap索引技术：每个attr使用一个bitmap表示每个tuple的值(估算10million tuple, 43000个zip codes则需要额外53.75GB，原因是zip作为attr数量太大)，需要考虑压缩方法</p>
<h2 id="Storage-Models-amp-Data-Layout"><a href="#Storage-Models-amp-Data-Layout" class="headerlink" title="Storage Models &amp; Data Layout"></a>Storage Models &amp; Data Layout</h2><p>主要mem DB的数据存储模型，注意C++使用<code>reinterpret_cast</code>在编译期强制转换类型，需要注意缓存对齐中的按字对齐(e.g. 64-bit word)</p>
<p>Null处理：定义特殊值, Bitmap表示, Null Flag</p>
<p>存储模型分为：</p>
<ul>
<li>N-ary Storage Model(NSM) 适合OLTP，insert-heavy，物理上使用堆组织或索引组织元组(比如使用聚族索引)</li>
<li>Decomposition Storage Model(DSM) 行存储又叫纵向扩展，适合OLAP,元组物理上使用固定长度或嵌入元组id</li>
<li>Hybrid Model 可以切换或同时适配</li>
</ul>
<p>可以观察到刚插入的数据一般都比较活跃，时间推移后期一般变成只读数据，OLTP通过ETL过程进入OLAP数据仓库</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2016/02/13/db-from-cmu-2016-two/" data-id="cjap5ltub003kb8rldoz2mczj" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2016/02/13/db-from-cmu-2016-two/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/锁/">锁</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-db-from-cmu-2016" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/05/db-from-cmu-2016/" class="article-date">
  <time datetime="2016-02-05T16:27:54.000Z" itemprop="datePublished">2016-02-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/课程总结/">课程总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/05/db-from-cmu-2016/">CMU课程15-721数据库系统设计（第一周）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CMU课程15-721最新一期开课啦！</p>
<p>真是要强烈推荐这门课程：有在线视频，有教案，有作业，甚至还有自动评分工具，除了没老师与TA之外真的分享了几乎所有的课程资源，完全可以让我们这种墙内的后进生们自学。</p>
<p><a href="http://15721.courses.cs.cmu.edu/spring2016/schedule.html" target="_blank" rel="noopener">课程安排</a></p>
<h2 id="Course-Introduction-and-History-of-Database-Systems"><a href="#Course-Introduction-and-History-of-Database-Systems" class="headerlink" title="Course Introduction and History of Database Systems"></a>Course Introduction and History of Database Systems</h2><p>以回顾数据库历史的方式串讲了数据库系统设计中的难点，也就是以后的课程内容目录：</p>
<ol>
<li>并发控制</li>
<li>索引</li>
<li>存储模型，压缩</li>
<li>join算法</li>
<li>日志与恢复</li>
<li>查询优化</li>
<li>新存储器件</li>
</ol>
<p>未来所有作业与项目都是用C++11写的（牛逼！），准备好调试多线程<br>推荐每次上课前写一篇本次课阅读paper的心得，包括：主题思想（两句话）、系统使用与修改情况（一句话）、负载测试情况（一句话）</p>
<h2 id="In-Memory-Databases"><a href="#In-Memory-Databases" class="headerlink" title="In-Memory Databases"></a>In-Memory Databases</h2><p>因为新型存储器件的飞速发展导致内存数据库（其实还有内存文件系统）需求越来越强烈，原始基于硬盘为主存储结构的数据库设计因此会有哪些变化呢？</p>
<p>总结下传统硬盘数据库设计特点为：</p>
<ol>
<li>使用内存做缓存池（涉及内存与磁盘上以“页”为单位的数据同步）</li>
<li>页为单位的索引数据组织（页号、slot号、header、tuple、blob等概念设计）</li>
<li>所有请求都会先经过缓存池（worker线程需要pin住该页防止被swap到磁盘）</li>
<li>并发控制保证事务可以等待磁盘数据读取时间，同时锁（lock）要保存到其他数据结构（非页结构）中防止被swap</li>
<li>使用WAL处理日志与恢复问题</li>
<li>CPU时间统计：30%缓存池、30%锁、28%日志、12%真正操作</li>
</ol>
<p>设计内存数据库，首先不要考虑使用mmap，缺点：内存操作无法非阻塞了、内存结构与磁盘必须相同、数据库系统不知道哪些页实际在内存中（说白了就是操作系统通用设计不可能比数据库架构师专业设计更好！） </p>
<p>内存数据库IO问题退居二线（DRAM 60ns， SSD 25000~30000ns），需要考虑其他性能问题：</p>
<ol>
<li>lock/latch</li>
<li>cache-line miss</li>
<li>pointer chasing</li>
<li>predicate evaluations</li>
<li>data move</li>
<li>network</li>
</ol>
<p>总结下设计特点为：</p>
<ol>
<li>不需要缓存池和页结构（直接用指针取代id索引？定长或变长数据？但是一定得使用checksum保证数据正确）</li>
<li>获得锁时间跟获得数据时间一样！导致可能允许牺牲一点并发度（coarse-grained locking因为数据IO足够快）并且可以将锁信息与数据信息一起保存（增加CPU cache locality，mutex相对太慢，一定改用CAS）</li>
<li>索引设计问题凸显（需要多考虑一下CPU cache）</li>
<li>查询处理方式巨大改变（不需要顺序扫描，传统一次处理一个tuple方式相对太慢），考虑vector-at-a-time</li>
<li>仍然需要WAL，可能可以简化；仍然需要checkpoint操作</li>
</ol>
<p>内容基本出自92年的文章: <a href="http://15721.courses.cs.cmu.edu/spring2016/papers/p298-larson.pdf" target="_blank" rel="noopener">High-Performance Concurrency Control Mechanisms for Main-Memory Databases</a></p>
<p>发布第一次项目作业，等本人做完了另找时间写文章说明。</p>
<h2 id="Concurrency-Control-I"><a href="#Concurrency-Control-I" class="headerlink" title="Concurrency Control I"></a>Concurrency Control I</h2><p>介绍各种事务模型：nested trx、saga trx（其实在《事务处理》一书里面都已经见识过）</p>
<p>介绍各种并发控制方式：<br>Two-Phase Locking 和死锁避免方法</p>
<ul>
<li>DL_DETECT</li>
<li>NO_WAIT</li>
<li>WAIT_DIE</li>
</ul>
<p>Timestamp Ordering及优化方法</p>
<ul>
<li>Basic T/O</li>
<li>MVCC</li>
<li>OCC</li>
<li>H-STORE </li>
</ul>
<p>测试结果出自14年的文章: <a href="http://15721.courses.cs.cmu.edu/spring2016/papers/p209-yu.pdf" target="_blank" rel="noopener">Staring into the Abyss: An Evaluation of Concurrency Control with One Thousand Cores</a></p>
<p>个人补充：MC涉及多线程访问内存值，CC解决多CPU副本一致性</p>
<p><a href="http://www.yebangyu.org/blog/2016/01/09/memoryconsistencyandcachecoherence/" target="_blank" rel="noopener">Memory Consistency和Cache Coherence</a></p>
<h2 id="Concurrency-Control-II-—-Multi-versioning"><a href="#Concurrency-Control-II-—-Multi-versioning" class="headerlink" title="Concurrency Control II — Multi-versioning"></a>Concurrency Control II — Multi-versioning</h2><p>详细介绍隔离级别：比可串行化级别低一些的级别，包括REPEATABLE_READS, READ_COMMITTED </p>
<ul>
<li>Dirty Read 脏读（提前读到后面修改的内容）</li>
<li>Unrepeatable Read 不可重复读（事务里两次读操作，后一次读的不同）</li>
<li>Phantom Read 幻读（读到其他事务插入或删除的数据）</li>
</ul>
<p>产品方面voltDB完美支持可串行化，oracle11g最高支持SNAPSHOT_ISOLATION级别，新增两种级别：</p>
<ul>
<li><p>CURSOR_STABILITY 内部cursor持有锁，有时防止Lost Update（写操作覆盖顺序不对）</p>
</li>
<li><p>SNAPSHOT_ISOLATION 保证事务所见snapshot相同（不能强化到可串行化级别 2009新paper有可串行化snapshot方案），防止Write Skew（部分写更新）</p>
</li>
</ul>
<p>下面介绍多版本MVCC现代实现方法(timestamp-ordered好处在于不需要lock！)</p>
<p>mvcc设计考虑：</p>
<ul>
<li>version chains（oldest-to-newest[w]，newest-to-oldest[r]）</li>
<li>version storage（全量或delta存[回滚段]）</li>
<li>garbage collection（额外线程或合作，GC在重写负载造成15%额外负载]）</li>
</ul>
<p><strong>Hekaton(SQL Server)</strong></p>
<p>  事务开始结束都赋予时间戳, 为每个tuple维护版本链(BEGING, END, POINTER)，维护全局事务状态图(ACTIVE, VALIDATING[precommited,2PL不需要这个状态，因为锁即可保证]),事务维护元数据(Read set,Write set,Scan set[避免幻读],Commit dependency)，乐观事务在多核表现下明显好于悲观事务</p>
<p>  实现方面仅使用lock-free数据结构(没有latch或spin lock，使用bw-tree和skiplist，CAS)</p>
<p>  该系统设计11年论文：<a href="http://15721.courses.cs.cmu.edu/spring2016/papers/p298-larson.pdf" target="_blank" rel="noopener">High-Performance Concurrency Control Mechanisms for Main-Memory Databases</a></p>
<h2 id="Concurrency-Control-III-—-Optimistic"><a href="#Concurrency-Control-III-—-Optimistic" class="headerlink" title="Concurrency Control III — Optimistic"></a>Concurrency Control III — Optimistic</h2><p>首先讨论存储过程，产生于解决使用交互API问题（可以减少网络通信次数与等待）</p>
<ul>
<li>ODBC/JDBC</li>
<li>DBMS wire protocols</li>
</ul>
<p>存储过程的问题：不好版本控制与调试，不好移植</p>
<p>Optimistic方法 其中validation步骤：（可以并发进行）</p>
<ul>
<li>backword 与已经提交的事务判断</li>
<li>forword 与还未提交事务判断</li>
</ul>
<p>本课未学完待补充</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2016/02/05/db-from-cmu-2016/" data-id="cjap5ltue003pb8rlyaf80qao" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2016/02/05/db-from-cmu-2016/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVCC/">MVCC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/隔离级别/">隔离级别</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-why-greece-history" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/04/why-greece-history/" class="article-date">
  <time datetime="2016-02-04T13:48:19.000Z" itemprop="datePublished">2016-02-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/04/why-greece-history/">why-greece-history</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>All cultures seem to believe the idea that history is a kind of chart that guides its members in to the future. Hitory gets transmitted from generation to generation. </p>
<p>These stories of the past offer the members of a culture part of their identity while highlighting the culture’s origins, what is deemed important, and the most significant starting point of Western civilization, which is the culture that most powerfully shapes not only the west but most of world today. It seems to me to be evident that whatever it’s over characteristics, the West has created institutions of government and law that provide unprecedented freedom for its people. It has also invented a body of natural scientific knowledge and technological achievement that together made possible a level of health and material prosperity undreamed of in earlier times and unknown ouside the West and those places that have been influenced. </p>
<p>Society cannot achieve the full benefits of Western science and technology without commitment to reason and objectivity as essentail of knowledge. The primary of reason and the pursuit of objectivity therefore, both characteristic of the Western experience seem to me to be essential for the achievement of the desired goals almost anywhere in the world. Chance and accident often played a vital part in the material condition of life cannot take root and flourish without reason, although it was employed for all sorts of practical and intellectual purposes in some of these cultures, it still lacked independence from religion and it lacked the high status to challenge the most basic received ideas.</p>
<p>It rest on religious authority, tradition, and power with a painful understanding of the limitations of the greatness and possibilities before man that together, composes the tragic vision of the human condition that characterized classical Greek civilization. </p>
<p>incried at Apollo’s temple at Delphi, “know Thyself” “Nothing in Excess” known your own limitations as a fallible mortal(not divine) to train in virtue of the animals when prefected, so he is the worst when seperated from law and justice. For injustice is most dangerous when it is armed. A religion that worshipped a single all powerful deity, who is sharply seperated from human beings.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2016/02/04/why-greece-history/" data-id="cjap5ltwx008xb8rl19qo6ylm" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2016/02/04/why-greece-history/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/history/">history</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-stock-analysis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/01/stock-analysis/" class="article-date">
  <time datetime="2015-11-01T18:43:50.000Z" itemprop="datePublished">2015-11-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/金融/">金融</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/01/stock-analysis/">证券投资分析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#1. 基本理论</p>
<p>#2.<br>基本分析法：（把握价格走势）证券价值及价格基本要素分析，评估证券投资价值与合理价位，提出投资建议（宏观经济形势/行业特征/上市公司基本财务数据）<br>技术分析法：（把握局部走势）证券市场过去现在市场行为进行分析，应用数学逻辑探索变化规律来预测未来变化<br>量化分析法：</p>
<p>静态/动态套期保值，主动/被动套期保值<br>学术分析：价格偏离信息内容；基本分析：价格偏离价值；技术分析法：市场供求；行为分析：心里及行为不平衡</p>
<p>价值发现型：风险相对分散理念；价值培养型：风险共担理论</p>
<p>#3. 有价证券的价值分析与估值方法<br>虚拟价值–未来预期收益<br>市场价值与预期收益多少成正比，与市场利率高低成反比<br>货币的时间价值、复利、贴现 $ FV = PV(1+i)^n $, $ PV = FV/(1+i)^n$<br>现金流贴现与净现值：贴现率与现金流（贴现现值）成反比<br>市盈率(P/E) 周期弱公司，如制造业，服务业<br>市净率(P/B) 周期型公司<br>市值回报增长比(PEG) IT公司<br>权益价值=资产价值-负债价值(即账面价值)<br>现金流与贴现率：债券必要回报率(债券贴现率) = 真实无风险收益率+预期通货膨胀率+风险溢价(无风险利率)<br>(1+名义无风险收益率) = (1+真实无风险收益率) * (1+预期通货膨胀率)<br>零增长模型内部收益率：股票净现值 = 股票内在价值 - 投资成本 = 每期收益/必要收益率 - 投资成本<br>全价报价缺点含混债券价格涨跌真实原因、净价报价<br>付息债券定价，累息债券定价<br>赎回收益率（一般在利率调低时出现）<br>利率风险结构，期限结构（期限不同，收益率不同）<br>当期收益率Y=C/P 每年利息收益/债券价格，到期收益率（缺点零息债券不能用），内部报酬率(IRR)<br>PV=T/U, p理论价格，发行时价格</p>
<p>利息计算：</p>
<ol>
<li>短期债券ACT 360/180 累计利息 = 面值<em>年利率/每年付息次数</em>ACT/180</li>
<li>中长期 365天(交易所) </li>
<li>贴现式 实际天数计算</li>
</ol>
<p>期限结构与收益率曲线<br>内部收益率（报酬率）NPV V(内在价值) P(市价) 关系 V=P则NPV=0<br>零增长与可变增长模型（股息增长率）</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2015/11/01/stock-analysis/" data-id="cjap5ltw10077b8rlm1oes7nc" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2015/11/01/stock-analysis/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/债券/">债券</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/基金/">基金</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/期货/">期货</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/股票/">股票</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-whats-bad-in-zookeeper-design" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/15/whats-bad-in-zookeeper-design/" class="article-date">
  <time datetime="2015-10-15T20:00:11.000Z" itemprop="datePublished">2015-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/系统经验/">系统经验</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/15/whats-bad-in-zookeeper-design/">Zookeeper系统的不足</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前总结过Zookeeper的各种设计优点，但是这个系统的缺陷与优点同样突出，本文就是结合自己的使用经验，业界给出的评价对ZK的缺点进行的归纳，一方面归纳使用表现上的不足，另一方面根据个人经验总结出系统本身功能设计时的就存在的缺陷。同时也思考了相应对策与改进的办法，算是本人对ZK设计的完整的思考总结吧。最后还关注了下etcd这个后起之秀的设计，看看它是否已经弥补了ZK的不足，能否担当后继者。</p>
<h2 id="1-实际使用暴露的不足"><a href="#1-实际使用暴露的不足" class="headerlink" title="1.实际使用暴露的不足"></a>1.实际使用暴露的不足</h2><p>尽管ZK已经在工业界大量使用，但实际使用ZK时就会发现自己仍然面临种种问题，这里总结一下实际使用中系统暴露出的种种不足。</p>
<ol>
<li><p>API使用复杂</p>
<p>使用ZK最直观的感觉就是客户端API使用起来特别麻烦，因为ZK的实际逻辑模型是文件存储，其他逻辑都需要结合使用临时节点和回调机制来实现，API接口与实际需求之间差距非常大，说白了就是ZK官方提供的API太过底层，而且表现力不足。没有http访问接口，只能通过API访问，导致兼容性与表现各异。比如一个细节很容易坑人：</p>
<p>&gt;</p>
<blockquote>
<p>ZK不能确保任何客户端能够获取（即Read Request）到一样的数据，需要客户端自己同步：方法是客户端在获取数据之前调用org.apache.zookeeper.Async(Callback.VoidCallback, java.lang.Object) 完成sync操作. </p>
</blockquote>
</li>
<li><p>实际客户端逻辑复杂</p>
<p>因为ZK提供的是非常底层的API，所以要实现一个基础需求，开发者用户自己需要依靠这些底层API在客户端实现并维护一个异常复杂的逻辑，甚至官方自己都一度不能提供正确的逻辑。比如实现分布式锁时，需要开发者自己在客户端处理异步请求锁的时间判断与仲裁，很容易出错。因此实现了多种ZK常用功能的开源项目Curator取代了官方成为ZK事实标准上的客户端了，总算让开发者使用ZK时稍微轻松一些，能够专注到自己的业务逻辑上面。但是Curator方案仍然有问题无法避免。</p>
<blockquote>
<p>而 Curator 这类客户端的复杂性使得支持多语言环境较难，怎样保证两个语言的 recipe 的是行为一致的？基本没有办法通过自动化测试来保证正确性，只能不停地线上踩坑一个个排查。</p>
</blockquote>
</li>
<li><p>ZK异常状态判断</p>
<p>比逻辑更复杂的是开发者总是需要自己同时处理ZK通信中的异常状态，需要正确处理CONNECTION LOSS(连接断开) 和 SESSION EXPIRED(Session 过期)两类连接异常。一个典型的难题就是session的超时机制的问题</p>
<blockquote>
<p>The client will stay in disconnected state until the TCP connection is re-established with the cluster, at which point the watcher of the expired session will receive the “session expired” notification.</p>
</blockquote>
<p>甚至需要考虑包括业务方系统load变高，或者发生长时间gc，导致ZK重连甚至session过期的问题。</p>
</li>
<li><p>回调次数限制</p>
<p>ZK中所有Watch回调通知都是一次性的。同一个ZK客户端对某一个节点注册相同的watch，也只会收到一次通知。节点数据的版本变化会触发NodeDataChanged回调，这导致需要重复注册，而如果节点数据的更新频率很高的话，客户端肯定就无法收到所有回调通知了。</p>
</li>
<li><p>Zab协议与全系统的有效性</p>
<p>实际应用中ZK系统整体可靠性也不一定有保证，比如在跨机房部署方面，由于ZK集群只能有一个Leader，因此一旦机房之间连接出现故障，Leader就只能照顾一个机房，其他机房运行的业务模块由于没有Leader也都只能停掉。于是所有流量集中到有Leader的那个机房，很容易造成系统crash。</p>
<p>同时ZK对于网络隔离极度敏感，导致系统对于网络的任何风吹草动都会做出激烈反应。这是Zab协议本身的设计，一旦出现网络隔离，ZK就要发起选举流程。悲催的是Zab协议的选举过程比较慢，期间集群没有Leader也不能提供服务。造成本来半秒一秒的网络隔离造成的不可用时间被放大为选举不可用时间。</p>
</li>
<li><p>性能</p>
<p>ZK本身的性能比较有限。典型的ZK的tps大概是一万多，单个节点平均连接数是6K，watcher是30万，吞吐似乎还可以，但是时延就没那么乐观了。特别</p>
</li>
</ol>
<p>   响应时间、网络、缓存</p>
<p>   ​</p>
<ol>
<li><p>服务极限与可扩展性</p>
<p>​</p>
</li>
<li><p>存储极限与可扩展性</p>
<p>​</p>
</li>
</ol>
<h2 id="2-需求满足缺陷"><a href="#2-需求满足缺陷" class="headerlink" title="2.需求满足缺陷"></a>2.需求满足缺陷</h2><p>设计层面上的不足</p>
<ol>
<li>事务API能力不足</li>
<li>中心无仲裁能力</li>
<li>回调次数</li>
<li>可扩展性</li>
<li>Zab协议</li>
</ol>
<h2 id="3-怎样更好的设计"><a href="#3-怎样更好的设计" class="headerlink" title="3. 怎样更好的设计"></a>3. 怎样更好的设计</h2><ol>
<li><p>更丰富有效的API</p>
<p> 支持多IP，自动处理重连与恢复，服务端可以动态加入移除</p>
</li>
<li>委托服务端处理能力<br> script能力？像redis支持luaScript<br> 节点单独超时时间设计</li>
<li>横向可扩展性</li>
<li>JVM</li>
</ol>
<h2 id="4-继任者etcd？"><a href="#4-继任者etcd？" class="headerlink" title="4. 继任者etcd？"></a>4. 继任者etcd？</h2><ol>
<li>raft协议取代zab</li>
<li>go GC</li>
<li>restful API</li>
</ol>
<h2 id="5-参考资料"><a href="#5-参考资料" class="headerlink" title="5. 参考资料"></a>5. 参考资料</h2><ol>
<li><a href="http://codemacro.com/2014/09/21/zk-watch-benchmark" target="_blank" rel="noopener">zookeeper节点数与watch的性能测试</a></li>
<li><a href="http://blog.csdn.net/wwwsq/article/details/7644445" target="_blank" rel="noopener">对Zookeeper的一些分析</a></li>
<li><a href="http://cloud.51cto.com/art/201508/487445.htm" target="_blank" rel="noopener">ZooKeeper真的low吗？上千节点场景配置服务讨论</a></li>
<li><a href="http://www.aboutyun.com/blog-1328-2362.html" target="_blank" rel="noopener">Zookeeper常见问题整理</a></li>
<li><a href="https://www.douban.com/note/277477728/" target="_blank" rel="noopener">ZAB问题总结</a></li>
<li><a href="http://www.infoq.com/cn/articles/coreos-analyse-etcd" target="_blank" rel="noopener">剖析etcd</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chaozh.github.com/2015/10/15/whats-bad-in-zookeeper-design/" data-id="cjap5ltwu008pb8rlln41m6wf" class="article-share-link">Share</a>
      
        <a href="http://chaozh.github.com/2015/10/15/whats-bad-in-zookeeper-design/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/paxos/">paxos</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/raft/">raft</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zookeeper/">zookeeper</a></li></ul>

    </footer>
  </div>
  
</article>



  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/WordPress开发/">WordPress开发</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/产品设计/">产品设计</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后端语言/">后端语言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/新技术跟踪/">新技术跟踪</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/移动开发/">移动开发</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/系统架构/">系统架构</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/系统架构/项目经历/">项目经历</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/系统经验/">系统经验</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/课程总结/">课程总结</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/金融/">金融</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/面试总结/">面试总结</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/项目经历/">项目经历</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C++</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CPU/">CPU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/InnoDB/">InnoDB</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS模板/">JS模板</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/">JVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux设置/">Linux设置</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MVCC/">MVCC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/">Mac</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/">Redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/">TCP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WP主题/">WP主题</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WP实现/">WP实现</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WP插件/">WP插件</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WP设置/">WP设置</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebGL/">WebGL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zookeeper/">Zookeeper</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cache-coherence/">cache coherence</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es6/">es6</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fabric/">fabric</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/google/">google</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/history/">history</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html5/">html5</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios应用/">ios应用</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iptv/">iptv</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/join/">join</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/karma/">karma</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kv存储/">kv存储</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/memory/">memory</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mutex/">mutex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/paxos/">paxos</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raft/">raft</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/url重定向/">url重定向</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web2-0/">web2.0</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/">zookeeper</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/中文汉化/">中文汉化</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/事务/">事务</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/互联网企业/">互联网企业</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/债券/">债券</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内核/">内核</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式锁/">分布式锁</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/区块链/">区块链</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/华为/">华为</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基金/">基金</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/外设/">外设</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/存储/">存储</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/实习/">实习</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源项目/">开源项目</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/敏捷开发/">敏捷开发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/无锁并发/">无锁并发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/日志/">日志</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/期货/">期货</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/栅格系统/">栅格系统</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/科研/">科研</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/索引/">索引</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编译器/">编译器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/股票/">股票</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/脚本加载/">脚本加载</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/腾讯/">腾讯</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/苹果/">苹果</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/语法/">语法</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读写锁/">读写锁</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/调度/">调度</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/金山/">金山</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/锁/">锁</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/键盘/">键盘</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/隔离级别/">隔离级别</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试/">面试</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/项目管理/">项目管理</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/CPU/" style="font-size: 10px;">CPU</a> <a href="/tags/CSS/" style="font-size: 11.67px;">CSS</a> <a href="/tags/InnoDB/" style="font-size: 10px;">InnoDB</a> <a href="/tags/JS模板/" style="font-size: 11.67px;">JS模板</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/Linux设置/" style="font-size: 10px;">Linux设置</a> <a href="/tags/MVCC/" style="font-size: 10px;">MVCC</a> <a href="/tags/Mac/" style="font-size: 10px;">Mac</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 11.67px;">PHP</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/WP主题/" style="font-size: 16.67px;">WP主题</a> <a href="/tags/WP实现/" style="font-size: 10px;">WP实现</a> <a href="/tags/WP插件/" style="font-size: 16.67px;">WP插件</a> <a href="/tags/WP设置/" style="font-size: 11.67px;">WP设置</a> <a href="/tags/WebGL/" style="font-size: 11.67px;">WebGL</a> <a href="/tags/Zookeeper/" style="font-size: 10px;">Zookeeper</a> <a href="/tags/cache-coherence/" style="font-size: 10px;">cache coherence</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/es6/" style="font-size: 10px;">es6</a> <a href="/tags/fabric/" style="font-size: 11.67px;">fabric</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/google/" style="font-size: 11.67px;">google</a> <a href="/tags/history/" style="font-size: 10px;">history</a> <a href="/tags/html5/" style="font-size: 15px;">html5</a> <a href="/tags/ios应用/" style="font-size: 10px;">ios应用</a> <a href="/tags/iptv/" style="font-size: 10px;">iptv</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/join/" style="font-size: 10px;">join</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/karma/" style="font-size: 10px;">karma</a> <a href="/tags/kv存储/" style="font-size: 10px;">kv存储</a> <a href="/tags/memory/" style="font-size: 10px;">memory</a> <a href="/tags/mutex/" style="font-size: 10px;">mutex</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/nodejs/" style="font-size: 13.33px;">nodejs</a> <a href="/tags/paxos/" style="font-size: 11.67px;">paxos</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/raft/" style="font-size: 10px;">raft</a> <a href="/tags/url重定向/" style="font-size: 10px;">url重定向</a> <a href="/tags/web2-0/" style="font-size: 10px;">web2.0</a> <a href="/tags/zookeeper/" style="font-size: 11.67px;">zookeeper</a> <a href="/tags/中文汉化/" style="font-size: 11.67px;">中文汉化</a> <a href="/tags/事务/" style="font-size: 11.67px;">事务</a> <a href="/tags/互联网企业/" style="font-size: 11.67px;">互联网企业</a> <a href="/tags/债券/" style="font-size: 11.67px;">债券</a> <a href="/tags/内核/" style="font-size: 11.67px;">内核</a> <a href="/tags/分布式锁/" style="font-size: 10px;">分布式锁</a> <a href="/tags/区块链/" style="font-size: 13.33px;">区块链</a> <a href="/tags/华为/" style="font-size: 10px;">华为</a> <a href="/tags/基金/" style="font-size: 11.67px;">基金</a> <a href="/tags/外设/" style="font-size: 10px;">外设</a> <a href="/tags/存储/" style="font-size: 10px;">存储</a> <a href="/tags/实习/" style="font-size: 15px;">实习</a> <a href="/tags/开源项目/" style="font-size: 10px;">开源项目</a> <a href="/tags/敏捷开发/" style="font-size: 10px;">敏捷开发</a> <a href="/tags/数据库/" style="font-size: 18.33px;">数据库</a> <a href="/tags/无锁并发/" style="font-size: 10px;">无锁并发</a> <a href="/tags/日志/" style="font-size: 10px;">日志</a> <a href="/tags/期货/" style="font-size: 11.67px;">期货</a> <a href="/tags/栅格系统/" style="font-size: 10px;">栅格系统</a> <a href="/tags/科研/" style="font-size: 10px;">科研</a> <a href="/tags/算法/" style="font-size: 18.33px;">算法</a> <a href="/tags/索引/" style="font-size: 11.67px;">索引</a> <a href="/tags/编译器/" style="font-size: 10px;">编译器</a> <a href="/tags/网络/" style="font-size: 10px;">网络</a> <a href="/tags/股票/" style="font-size: 11.67px;">股票</a> <a href="/tags/脚本加载/" style="font-size: 10px;">脚本加载</a> <a href="/tags/腾讯/" style="font-size: 15px;">腾讯</a> <a href="/tags/苹果/" style="font-size: 10px;">苹果</a> <a href="/tags/语法/" style="font-size: 11.67px;">语法</a> <a href="/tags/读写锁/" style="font-size: 10px;">读写锁</a> <a href="/tags/调度/" style="font-size: 10px;">调度</a> <a href="/tags/金山/" style="font-size: 10px;">金山</a> <a href="/tags/锁/" style="font-size: 10px;">锁</a> <a href="/tags/键盘/" style="font-size: 10px;">键盘</a> <a href="/tags/隔离级别/" style="font-size: 10px;">隔离级别</a> <a href="/tags/面试/" style="font-size: 20px;">面试</a> <a href="/tags/项目管理/" style="font-size: 11.67px;">项目管理</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">September 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">August 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/09/">September 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">June 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">September 2011</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/12/02/Qconf-summary/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/12/02/Introduction-to-Basic-Fixed-Income-Securities/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/04/08/blockchain-tech-summary/">区块链技术总结与架构实战</a>
          </li>
        
          <li>
            <a href="/2017/03/23/fabric-ca-design/">Hyperledger Fabric CA设计</a>
          </li>
        
          <li>
            <a href="/2017/02/05/sicp-charpter-two/">SICP第二章总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Chao Zheng<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  </footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/php-development-env-setup-in-win7-x64.html" class="mobile-nav-link">PHP-WIN</a>
  
</nav>
    
<script>
  var disqus_shortname = 'chaozh';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>